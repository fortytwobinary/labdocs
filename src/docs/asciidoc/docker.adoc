Docker
======
FortyTwoBinary Team
:description: installation reference
:toc: left
:icons: font
:stylesheet: italian-pop.css
:docinfo: shared
:numbered:
:website: https://fortytwobinary.com/
:author: David L. Whitehurst

{endpoint-url}/welcome.html[home]

image:vy.png["Company Logo",height=32]

Welcome to the FortyTwoBinary service documentation for Docker
on multiple platforms. This document is subject to great change and will
be maintained in a software repository http://192.168.1.7/infrastructure/documentation[here].

[WARNING]
This {description} was drafted and is maintained as a DevOps reference to the work that occurs on the FortyTwoBinary network and infrastructure. The
powerful command-line instructions found here, may or may not be accurate
or timely. This warning is given to let the DevOp be aware that commands
may not be idempotent and before root-level (sudo) actions are taken, to
please think twice before hitting the Enter key.

.This document
**********************************************************************
This document was written using asciidoc markup and the HTML you see is
generated by a tool driven using Python called asciidoctor. This
{description} is a powerful document that can be of great value in the event of data loss, machine crashes, backups, maintenance, installations, and troubleshooting.
**********************************************************************


Introduction
------------
The network and infrastructure playbook is a compilation of the notes,
configurations, how-tos, general, and technical documentation that will
follow the evolution of the FortyTwoBinary network. This treatise will
outline and describe the network, the configurations, the machines,
and the software the operates over it.

The FortyTwoBinary network is an internal network behind a home ISP or
Internet Service Provider and protected from the public internet via
a secure and highly configured network router.

FortyTwoBinary is a made up organization name for our home network and
used in the event that other people join me in my learning and education.

.My Mission
**********************************************************************
Kubernetes has emerged as powerful way to serve web content and move
data over the internet at grand scale. This is very expensive even for
well-paid consultants to learn on their own. Small computers and virtual
machines are inexpensive and convenient to own. My mission is to learn
more about containers, hosting, and clustering all on my own time and
do this economically of course.

Turing Pi is now making a cluster board for multiple Raspberry Pi boards
and the cluster capability for up to 28 cores or 7 Raspberry Pi computers.
Canonical Ubuntu is also producing a software product called MicroK8s or
what they call a no-more, no-less version of Kubernetes that will run on
a single server host. The FortyTwoBinary network (my home network) is
slowly becoming a laboratory for learning.
**********************************************************************

Preliminaries
-------------

Goal
~~~~
The goal here is to install and maintain a single instance of a running
Hashicorp Vault in production mode on a Raspberry Pi 4 Model B.

Platforms
~~~~~~~~~
As stated in the Goal section above, the platform for installation and
service is the Raspberry Pi 4 Model B. We recently procured 3 Labist
starter kits with the new Raspberry Pi 4 Model B machines. These boards
have 8GB of fixed RAM and Raspbian (Debian 10 Buster) OS for arm64 (arm7l)
came on a 128GB Sansdisk microSD card. Exceptionally easy startup and our
3 machines are now online, running, and accessible via static IPs.

Dependencies
~~~~~~~~~~~~
Dependencies can be software packages, configurations, or even tools that
need to be available during the process of installation. In this case,
everything was available. An ssh connection to the Raspberry Pi allowed
for a smooth installation of the Vault binary for this platform. VIM was
installed but VI was present at initial boot.

We want to note that the initial binary did not work correctly. We
also tried a Docker version prior to a strict server install. It seems
that a 64bit edition for the ARM processor is yet to be available. We will
periodically check for this and upgrade when available.

Installation Raspberry Pi 4 Model B
-----------------------------------
Text here ...

TIP: Download the Vault binary for Raspberry Pi 4 Model B here: https://releases.hashicorp.com/vault/1.6.2/vault_1.6.2_linux_arm.zip[https://releases.hashicorp.com/vault/1.6.2/vault_1.6.2_linux_arm.zip]

Installation Debian 10 Buster
-----------------------------
Text here ...

TIP: Download the Vault binary for Raspberry Pi 4 Model B here: https://releases.hashicorp.com/vault/1.6.2/vault_1.6.2_linux_arm.zip[https://releases.hashicorp.com/vault/1.6.2/vault_1.6.2_linux_arm.zip]

Installation Ubuntu 20.4 LTS
----------------------------
Text here ...

TIP: Download the Vault binary for Raspberry Pi 4 Model B here: https://releases.hashicorp.com/vault/1.6.2/vault_1.6.2_linux_arm.zip[https://releases.hashicorp.com/vault/1.6.2/vault_1.6.2_linux_arm.zip]

[WARNING]
Do NOT download the ARM64 edition for Linux. It will NOT run on the Raspberry Pi 4 Model B using Raspbian (Debian 10 Buster) as of February 27, 2021. This message is HIGHLY subject to CHANGE.

Unzip the download somewhere and we moved the file `vault` to `<user-home>/bin` Then we added the following to our `.bashrc` and sourced it instead of logging out and back in.

[source,bash]
----
export PATH=/home/pi/bin:$PATH
----
Now our user (pi) can execute the vault program from anywhere. The only
caveat is that with the command, a configuration is needed. Let's create
the configuration for Vault in the user's home directory. We'll then run
the executable and discuss optimum configuration in the <<X5>>
section below.

Configuration
~~~~~~~~~~~~~
Hashicorp Vault can be configured using JSON or <<X900>>. We chose to use
JSON only for familiarity. Create a file called `vault-config.json` in the
user's home directory and add this content:

[source,json]
----
{
  "backend": {
    "file": {
      "path": "vault/data"
    }
  },
  "listener": {
    "tcp":{
      "address": "0.0.0.0:8200",
      "tls_disable": 1
    }
  },
  "ui": true
}
----
Take note that the path `vault/data` will be relative to where the vault
executable is run. We will issue the command from the user's home directory
and where this configuration file currently resides. Also the `0.0.0.0` in
the listener section is a placeholder that defines a non-routable IP address. It has been explained to mean "all addresses". Learn more here:
https://en.wikipedia.org/wiki/0.0.0.0[https://en.wikipedia.org/wiki/0.0.0.0]. The 8200 port is the Hashicorp Vault default.

[WARNING]
Please note that HTTPS is not being used. This is NOT good practice however, final software configuration may occur within the FortyTwoBinary
network (internal) or in the event all configuration is moved onto the
public Internet.

Startup
~~~~~~~
N/A

Administration
--------------
The full administration and use of Docker is yet to be discovered. For now
we'll provide some cheatsheet commands and a few use cases.

Common Commands
~~~~~~~~~~~~~~~
Later ... you are welcome lol ...

[source,bash]
----
$ docker ps
----

:numbered!:

[appendix]
License
-------
This document is licensed by the Apache License version 2.0. Currently,
the content in this document is being kept from the public however, in
the event the material contained here is willingly shared with
others, the license will remain unchanged and will convey with the
transference of the material.

Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/

A copy has also been provided with this software repository.

Copyright (C) 2021 David L Whitehurst.
